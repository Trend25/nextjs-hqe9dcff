(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{4211:function(e,r,l){Promise.resolve().then(l.bind(l,5971))},617:function(e,r,l){"use strict";l.r(r),l.d(r,{ClientAuthProvider:function(){return m},useAuth:function(){return D}});var t=l(3827),s=l(4090),o=l(7176),a=l(7907);console.log("\uD83D\uDD0D DEBUG: ClientAuthProvider file loaded at:",new Date().toISOString());let n="https://hfrzxhbwjatdnpftrdgr.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhmcnp4aGJ3amF0ZG5wZnRyZGdyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI5NTY3NzksImV4cCI6MjA2ODUzMjc3OX0.Fg7TK4FckPi5XAWNM_FLii9WyzSDAUCSdyoX-WLLXhA";i||(console.error("\uD83D\uDEA8 ERROR: NEXT_PUBLIC_SUPABASE_ANON_KEY not found in environment variables!"),console.error("\uD83D\uDD27 Please set NEXT_PUBLIC_SUPABASE_ANON_KEY in Vercel environment variables")),console.log("\uD83D\uDD0D DEBUG: Environment Variables Config:"),console.log("\uD83D\uDD0D DEBUG: - URL:",n),console.log("\uD83D\uDD0D DEBUG: - Key length:",i.length),console.log("\uD83D\uDD0D DEBUG: - Key starts with:",i.substring(0,20)),console.log("\uD83D\uDD0D DEBUG: - Using env vars:",!!i);let u=(0,o.eI)(n,i);console.log("\uD83D\uDD0D DEBUG: Supabase client created");let c=(0,s.createContext)(void 0),d=()=>{try{let e=localStorage.getItem("sb-hfrzxhbwjatdnpftrdgr-auth-token");return e?JSON.parse(e):null}catch(e){return null}};function m(e){let{children:r}=e,l=(0,a.useRouter)(),o=(0,a.usePathname)(),n=d();console.log("\uD83D\uDD0D DEBUG: Initial auth from storage:",!!n);let[i,m]=(0,s.useState)((null==n?void 0:n.user)||null),[D,f]=(0,s.useState)(null),[h,g]=(0,s.useState)(!n),x=async e=>{var r,l,t;console.log("\uD83D\uDD0D DEBUG: fetchUserProfile for",e);try{let{data:r,error:l}=await u.from("profiles").select("*").eq("id",e).maybeSingle();if(l)throw l;if(r)return r}catch(e){console.error("\uD83D\uDD0D DEBUG: Error fetching profile:",e)}return{id:e,email:(null==n?void 0:null===(r=n.user)||void 0===r?void 0:r.email)||"",full_name:(null==n?void 0:null===(t=n.user)||void 0===t?void 0:null===(l=t.user_metadata)||void 0===l?void 0:l.full_name)||"",avatar_url:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}},b=async(e,r)=>{if(i)try{await u.from("user_activity_log").insert({user_id:i.id,activity_type:e,activity_data:r,ip_address:null,user_agent:navigator.userAgent})}catch(e){console.error("\uD83D\uDD0D DEBUG: Error logging activity:",e)}};(0,s.useEffect)(()=>{console.log("\uD83D\uDD0D DEBUG: AuthProvider mounted");let e=!0,r=setTimeout(()=>{e&&h&&(console.log("\uD83D\uDEA8 DEBUG: Loading timeout, forcing loading=false"),g(!1))},15e3);(async()=>{console.log("\uD83D\uDD0D DEBUG: getSession");try{let{data:{session:r},error:l}=await u.auth.getSession();if(l)throw l;if(null==r?void 0:r.user){m(r.user);let l=await x(r.user.id);if(!e)return;f(l)}else if(null==n?void 0:n.user){m(n.user);let r=await x(n.user.id);if(!e)return;f(r)}else localStorage.removeItem("sb-hfrzxhbwjatdnpftrdgr-auth-token"),m(null)}catch(e){console.error("\uD83D\uDD0D DEBUG: init error:",e)}finally{e&&g(!1),clearTimeout(r)}})();let{data:{subscription:t}}=u.auth.onAuthStateChange(async(t,s)=>{if(console.log("\uD83D\uDD0D DEBUG: onAuthStateChange",t),null==s?void 0:s.user){m(s.user);let r=await x(s.user.id);e&&f(r),"SIGNED_IN"===t&&"/dashboard"!==o&&l.push("/dashboard"),"SIGNED_IN"===t&&await b("login")}else m(null),f(null);e&&g(!1),clearTimeout(r)});return()=>{e=!1,t.unsubscribe(),clearTimeout(r)}},[l,o]);let p=async(e,r,l)=>{console.log("\uD83D\uDD0D DEBUG: signUp called for email:",e),g(!0);try{let{data:t,error:s}=await u.auth.signUp({email:e,password:r,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback"),data:{full_name:l||""}}});if(s)throw s;return console.log("\uD83D\uDD0D DEBUG: signUp successful:",t),{data:t,error:null}}catch(e){return console.error("\uD83D\uDD0D DEBUG: Sign up error:",e),{data:null,error:e.message}}finally{g(!1)}},w=async(e,r)=>{console.log("\uD83D\uDD0D DEBUG: signIn called for email:",e),g(!0);try{let{data:l,error:t}=await u.auth.signInWithPassword({email:e,password:r});if(t)throw t;return console.log("\uD83D\uDD0D DEBUG: signIn successful:",l),{data:l,error:null}}catch(e){return console.error("\uD83D\uDD0D DEBUG: Sign in error:",e),{data:null,error:e.message}}finally{g(!1)}},y=async()=>{console.log("\uD83D\uDD0D DEBUG: signOut called"),g(!0),i&&await b("logout");try{let{error:e}=await u.auth.signOut();if(e)throw e;console.log("\uD83D\uDD0D DEBUG: signOut successful")}catch(e){console.error("\uD83D\uDD0D DEBUG: signOut error:",e)}finally{m(null),f(null),g(!1)}},v=async e=>{if(console.log("\uD83D\uDD0D DEBUG: updateProfile called:",e),!i||!D)throw Error("No user logged in");g(!0);try{let{data:r,error:l}=await u.from("profiles").update({...e,updated_at:new Date().toISOString()}).eq("id",i.id).select().single();if(l)throw l;return f(r),await b("profile_update",e),console.log("\uD83D\uDD0D DEBUG: updateProfile successful:",r),{data:r,error:null}}catch(e){return console.error("\uD83D\uDD0D DEBUG: Update profile error:",e),{data:null,error:e.message}}finally{g(!1)}},N=async()=>{if(console.log("\uD83D\uDD0D DEBUG: refreshProfile called"),i)try{let e=await x(i.id);f(e),console.log("\uD83D\uDD0D DEBUG: Profile refreshed")}catch(e){console.error("\uD83D\uDD0D DEBUG: Error refreshing profile:",e)}},j=!!(null==i?void 0:i.email_confirmed_at);return(0,t.jsx)(c.Provider,{value:{user:i,userProfile:D,loading:h,isEmailVerified:j,signUp:p,signIn:w,signOut:y,updateProfile:v,refreshProfile:N,logActivity:b},children:r})}function D(){let e=(0,s.useContext)(c);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}r.default=m},5971:function(e,r,l){"use strict";l.r(r),l.d(r,{default:function(){return u}});var t=l(3827),s=l(4090),o=l(7907),a=l(617);function n(){return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),(0,t.jsx)("p",{className:"text-blue-600 font-medium",children:"Loading registration..."})]})})}function i(){let e=(0,o.useRouter)(),r=(0,o.useSearchParams)(),{signUp:l,user:n,loading:i}=(0,a.useAuth)(),[u,c]=(0,s.useState)({fullName:"",email:"",password:"",confirmPassword:"",role:"entrepreneur"}),[d,m]=(0,s.useState)({}),[D,f]=(0,s.useState)(!1),[h,g]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(n&&!i){let l=(null==r?void 0:r.get("redirect"))||"/dashboard";e.push(l)}},[n,i,e,r]);let x=()=>{let e={};return u.fullName.trim()||(e.fullName="Full name is required"),u.email.trim()?/\S+@\S+\.\S+/.test(u.email)||(e.email="Email is invalid"):e.email="Email is required",u.password?u.password.length<8&&(e.password="Password must be at least 8 characters"):e.password="Password is required",u.password!==u.confirmPassword&&(e.confirmPassword="Passwords do not match"),m(e),0===Object.keys(e).length},b=async e=>{if(e.preventDefault(),x()){f(!0),m({});try{let{data:e,error:r}=await l(u.email,u.password,u.fullName);r?m({general:r}):g(!0)}catch(e){m({general:e||"An unexpected error occurred"})}finally{f(!1)}}},p=e=>{let{name:r,value:l}=e.target;c(e=>({...e,[r]:l})),d[r]&&m(e=>({...e,[r]:""}))};return h?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,t.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCE7"})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Check your email!"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-6",children:["We've sent a verification link to ",(0,t.jsx)("strong",{children:u.email}),". Click the link to verify your account and get started."]}),(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:(0,t.jsxs)("p",{className:"text-sm text-blue-800",children:["\uD83D\uDCA1 ",(0,t.jsx)("strong",{children:"Tip:"})," Check your spam folder if you don't see the email within a few minutes."]})}),(0,t.jsx)("button",{onClick:()=>e.push("/auth/login"),className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:"Go to Login"})]})}):i?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-8 text-white text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Join RateMyStartup"}),(0,t.jsx)("p",{className:"text-blue-100",children:"Start your free startup analysis"})]}),(0,t.jsxs)("form",{onSubmit:b,className:"p-8 space-y-6",children:[d.general&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,t.jsx)("p",{className:"text-sm text-red-800",children:d.general})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),(0,t.jsx)("input",{type:"text",id:"fullName",name:"fullName",value:u.fullName,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(d.fullName?"border-red-500":"border-gray-300"),placeholder:"John Doe"}),d.fullName&&(0,t.jsx)("p",{className:"text-sm text-red-600 mt-1",children:d.fullName})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),(0,t.jsx)("input",{type:"email",id:"email",name:"email",value:u.email,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(d.email?"border-red-500":"border-gray-300"),placeholder:"john@example.com"}),d.email&&(0,t.jsx)("p",{className:"text-sm text-red-600 mt-1",children:d.email})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-2",children:"I am a..."}),(0,t.jsxs)("select",{id:"role",name:"role",value:u.role,onChange:p,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"entrepreneur",children:"Entrepreneur / Founder"}),(0,t.jsx)("option",{value:"investor",children:"Investor / VC"}),(0,t.jsx)("option",{value:"advisor",children:"Advisor / Consultant"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,t.jsx)("input",{type:"password",id:"password",name:"password",value:u.password,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(d.password?"border-red-500":"border-gray-300"),placeholder:"At least 8 characters"}),d.password&&(0,t.jsx)("p",{className:"text-sm text-red-600 mt-1",children:d.password})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),(0,t.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:u.confirmPassword,onChange:p,className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(d.confirmPassword?"border-red-500":"border-gray-300"),placeholder:"Confirm your password"}),d.confirmPassword&&(0,t.jsx)("p",{className:"text-sm text-red-600 mt-1",children:d.confirmPassword})]}),(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:["By creating an account, you agree to our"," ",(0,t.jsx)("a",{href:"/terms",className:"text-blue-600 hover:underline",children:"Terms of Service"})," ","and"," ",(0,t.jsx)("a",{href:"/privacy",className:"text-blue-600 hover:underline",children:"Privacy Policy"}),"."]})}),(0,t.jsx)("button",{type:"submit",disabled:D,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:D?"Creating Account...":"Create Account"}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",(0,t.jsx)("button",{type:"button",onClick:()=>e.push("/auth/login"),className:"text-blue-600 hover:underline font-medium",children:"Sign in"})]})})]})]})})}function u(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)(n,{}),children:(0,t.jsx)(i,{})})}}},function(e){e.O(0,[612,971,69,744],function(){return e(e.s=4211)}),_N_E=e.O()}]);