(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[87],{4662:function(e,t,r){Promise.resolve().then(r.bind(r,3919))},617:function(e,t,r){"use strict";r.r(t),r.d(t,{ClientAuthProvider:function(){return d},useAuth:function(){return h}});var l=r(3827),n=r(4090),o=r(7176),a=r(7907);console.log("\uD83D\uDD0D DEBUG: ClientAuthProvider file loaded at:",new Date().toISOString());let s="https://hfrzxhbwjatdnpftrdgr.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhmcnp4aGJ3amF0ZG5wZnRyZGdyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI5NTY3NzksImV4cCI6MjA2ODUzMjc3OX0.Fg7TK4FckPi5XAWNM_FLii9WyzSDAUCSdyoX-WLLXhA";i||(console.error("\uD83D\uDEA8 ERROR: NEXT_PUBLIC_SUPABASE_ANON_KEY not found in environment variables!"),console.error("\uD83D\uDD27 Please set NEXT_PUBLIC_SUPABASE_ANON_KEY in Vercel environment variables")),console.log("\uD83D\uDD0D DEBUG: Environment Variables Config:"),console.log("\uD83D\uDD0D DEBUG: - URL:",s),console.log("\uD83D\uDD0D DEBUG: - Key length:",i.length),console.log("\uD83D\uDD0D DEBUG: - Key starts with:",i.substring(0,20)),console.log("\uD83D\uDD0D DEBUG: - Using env vars:",!!i);let u=(0,o.eI)(s,i);console.log("\uD83D\uDD0D DEBUG: Supabase client created");let c=(0,n.createContext)(void 0),D=()=>{try{let e=localStorage.getItem("sb-hfrzxhbwjatdnpftrdgr-auth-token");return e?JSON.parse(e):null}catch(e){return null}};function d(e){let{children:t}=e,r=(0,a.useRouter)(),o=(0,a.usePathname)(),s=D();console.log("\uD83D\uDD0D DEBUG: Initial auth from storage:",!!s);let[i,d]=(0,n.useState)((null==s?void 0:s.user)||null),[h,m]=(0,n.useState)(null),[g,f]=(0,n.useState)(!s),p=async e=>{var t,r,l;console.log("\uD83D\uDD0D DEBUG: fetchUserProfile for",e);try{let{data:t,error:r}=await u.from("profiles").select("*").eq("id",e).maybeSingle();if(r)throw r;if(t)return t}catch(e){console.error("\uD83D\uDD0D DEBUG: Error fetching profile:",e)}return{id:e,email:(null==s?void 0:null===(t=s.user)||void 0===t?void 0:t.email)||"",full_name:(null==s?void 0:null===(l=s.user)||void 0===l?void 0:null===(r=l.user_metadata)||void 0===r?void 0:r.full_name)||"",avatar_url:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}},x=async(e,t)=>{if(i)try{await u.from("user_activity_log").insert({user_id:i.id,activity_type:e,activity_data:t,ip_address:null,user_agent:navigator.userAgent})}catch(e){console.error("\uD83D\uDD0D DEBUG: Error logging activity:",e)}};(0,n.useEffect)(()=>{console.log("\uD83D\uDD0D DEBUG: AuthProvider mounted");let e=!0,t=setTimeout(()=>{e&&g&&(console.log("\uD83D\uDEA8 DEBUG: Loading timeout, forcing loading=false"),f(!1))},15e3);(async()=>{console.log("\uD83D\uDD0D DEBUG: getSession");try{let{data:{session:t},error:r}=await u.auth.getSession();if(r)throw r;if(null==t?void 0:t.user){d(t.user);let r=await p(t.user.id);if(!e)return;m(r)}else if(null==s?void 0:s.user){d(s.user);let t=await p(s.user.id);if(!e)return;m(t)}else localStorage.removeItem("sb-hfrzxhbwjatdnpftrdgr-auth-token"),d(null)}catch(e){console.error("\uD83D\uDD0D DEBUG: init error:",e)}finally{e&&f(!1),clearTimeout(t)}})();let{data:{subscription:l}}=u.auth.onAuthStateChange(async(l,n)=>{if(console.log("\uD83D\uDD0D DEBUG: onAuthStateChange",l),null==n?void 0:n.user){d(n.user);let t=await p(n.user.id);e&&m(t),"SIGNED_IN"===l&&"/dashboard"!==o&&r.push("/dashboard"),"SIGNED_IN"===l&&await x("login")}else d(null),m(null);e&&f(!1),clearTimeout(t)});return()=>{e=!1,l.unsubscribe(),clearTimeout(t)}},[r,o]);let y=async(e,t,r)=>{console.log("\uD83D\uDD0D DEBUG: signUp called for email:",e),f(!0);try{let{data:l,error:n}=await u.auth.signUp({email:e,password:t,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback"),data:{full_name:r||""}}});if(n)throw n;return console.log("\uD83D\uDD0D DEBUG: signUp successful:",l),{data:l,error:null}}catch(e){return console.error("\uD83D\uDD0D DEBUG: Sign up error:",e),{data:null,error:e.message}}finally{f(!1)}},b=async(e,t)=>{console.log("\uD83D\uDD0D DEBUG: signIn called for email:",e),f(!0);try{let{data:r,error:l}=await u.auth.signInWithPassword({email:e,password:t});if(l)throw l;return console.log("\uD83D\uDD0D DEBUG: signIn successful:",r),{data:r,error:null}}catch(e){return console.error("\uD83D\uDD0D DEBUG: Sign in error:",e),{data:null,error:e.message}}finally{f(!1)}},E=async()=>{console.log("\uD83D\uDD0D DEBUG: signOut called"),f(!0),i&&await x("logout");try{let{error:e}=await u.auth.signOut();if(e)throw e;console.log("\uD83D\uDD0D DEBUG: signOut successful")}catch(e){console.error("\uD83D\uDD0D DEBUG: signOut error:",e)}finally{d(null),m(null),f(!1)}},v=async e=>{if(console.log("\uD83D\uDD0D DEBUG: updateProfile called:",e),!i||!h)throw Error("No user logged in");f(!0);try{let{data:t,error:r}=await u.from("profiles").update({...e,updated_at:new Date().toISOString()}).eq("id",i.id).select().single();if(r)throw r;return m(t),await x("profile_update",e),console.log("\uD83D\uDD0D DEBUG: updateProfile successful:",t),{data:t,error:null}}catch(e){return console.error("\uD83D\uDD0D DEBUG: Update profile error:",e),{data:null,error:e.message}}finally{f(!1)}},N=async()=>{if(console.log("\uD83D\uDD0D DEBUG: refreshProfile called"),i)try{let e=await p(i.id);m(e),console.log("\uD83D\uDD0D DEBUG: Profile refreshed")}catch(e){console.error("\uD83D\uDD0D DEBUG: Error refreshing profile:",e)}},w=!!(null==i?void 0:i.email_confirmed_at);return(0,l.jsx)(c.Provider,{value:{user:i,userProfile:h,loading:g,isEmailVerified:w,signUp:y,signIn:b,signOut:E,updateProfile:v,refreshProfile:N,logActivity:x},children:t})}function h(){let e=(0,n.useContext)(c);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}t.default=d},3919:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return s}});var l=r(3827),n=r(4090),o=r(7907),a=r(617);function s(){let{user:e}=(0,a.useAuth)(),t=(0,o.useRouter)(),r=function(){let[e,t]=(0,n.useState)(null);return(0,n.useEffect)(()=>{t(new URLSearchParams(window.location.search))},[]),e}(),[s,i]=(0,n.useState)([]),[u,c]=(0,n.useState)(!0),D=(null==r?void 0:r.get("type"))||"entrepreneur";return((0,n.useEffect)(()=>{if(!e){t.push("/auth/login");return}let r=[{id:"1",companyName:"TechStartup A",email:"founder@techstartup.com",submittedAt:"2024-01-15",userType:"entrepreneur"},{id:"2",companyName:"FinTech B",email:"ceo@fintech.com",submittedAt:"2024-01-10",userType:"entrepreneur"}];setTimeout(()=>{i(r),c(!1)},1e3)},[e,t]),u)?(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Veriler y\xfckleniyor..."})]})}):(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,l.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["\uD83D\uDCCA Form Sonu\xe7ları - ","entrepreneur"===D?"Girişimci":"Yatırımcı"," Paneli"]}),(0,l.jsx)("button",{onClick:()=>t.push("/form"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"➕ Yeni Form"})]}),0===s.length?(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("p",{className:"text-gray-500 text-lg",children:"Hen\xfcz form submission'ı yok."}),(0,l.jsx)("button",{onClick:()=>t.push("/form"),className:"mt-4 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"İlk Formu Oluştur"})]}):(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full table-auto",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,l.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Şirket Adı"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Email"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Kullanıcı Tipi"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Tarih"}),(0,l.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"İşlemler"})]})}),(0,l.jsx)("tbody",{children:s.map(e=>(0,l.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"py-3 px-4 font-medium text-gray-900",children:e.companyName}),(0,l.jsx)("td",{className:"py-3 px-4 text-gray-600",children:e.email}),(0,l.jsx)("td",{className:"py-3 px-4",children:(0,l.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("entrepreneur"===e.userType?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"),children:"entrepreneur"===e.userType?"Girişimci":"Yatırımcı"})}),(0,l.jsx)("td",{className:"py-3 px-4 text-gray-600",children:e.submittedAt}),(0,l.jsx)("td",{className:"py-3 px-4",children:(0,l.jsx)("button",{onClick:()=>t.push("/stage-detection?company=".concat(e.companyName)),className:"text-blue-600 hover:text-blue-800 font-medium",children:"Analiz Et →"})})]},e.id))})]})}),(0,l.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200 text-center",children:(0,l.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,l.jsx)("button",{onClick:()=>t.push("/"),className:"bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-medium hover:bg-gray-400 transition-colors",children:"\uD83C\uDFE0 Ana Sayfa"}),(0,l.jsx)("button",{onClick:()=>t.push("/stage-detection"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"\uD83D\uDE80 Stage Analizi"})]})})]})})})}}},function(e){e.O(0,[612,971,69,744],function(){return e(e.s=4662)}),_N_E=e.O()}]);